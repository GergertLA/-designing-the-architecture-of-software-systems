# Лабораторная работа №2
**Тема:** Использование нотации C4 model для проектирования архитектуры программной системы
**Цель работы:** Получить опыт использования графической нотации для фиксации архитектурных решений.

## Диаграмма системного контекста

![Untitled - Context](https://github.com/user-attachments/assets/b732bfec-8fb9-4446-88c9-97357218fc34)

### Внешние пользователи:
Трейдер - основной пользователь системы, который просматривает результаты анализа тональности новостей, динамику влияния событий на цену Bitcoin и использует аналитические данные для поддержки торговых решений.

Администратор - отвечает за управление системой: конфигурацию источников данных, настройку параметров сбора и обработки новостей, мониторинг корректности работы и поддержание работоспособности компонентов системы.

### Центральная система:
NewsSentimentAnalyzer - целевая программная система, выполняющая сбор новостей, предобработку текстов, анализ тональности и классификацию, сопоставление новостных событий с движением цены Bitcoin, а также визуализацию аналитических результатов и отправку уведомлений пользователям.

### Внешние системы и сервисы:
Источники новостей - сторонние криптовалютные и финансовые медиа, API-агрегаторы и социальные платформы, из которых система получает текстовые новостные данные для дальнейшего анализа.

Провайдеры ценовых данных - биржи криптовалют, агрегаторы котировок или рыночные API, предоставляющие исторические и текущие данные о цене и объёмах торгов Bitcoin, необходимые для проведения корреляционного анализа.

Notification Service - сервис доставки уведомлений (Email, Telegram и др.), который получает сформированные системой алерты и обеспечивает их доставку конечным пользователям.

## Диаграмма контейнеров

![Untitled - Container (1)](https://github.com/user-attachments/assets/c8b97a04-aa75-4496-bf12-f47bf66f54bb)

### Описание основных элементов:
Grafana Dashboards — единственный пользовательский интерфейс. Подключается к базе данных через SQL-запросы, отображает дашборды с тональностью и прогнозами, управляет правилами алертов и при срабатывании посылает уведомления во внешние каналы.

Database (Postgres) — хранит результаты анализа тональности (tone, confidence), прогнозы влияния на цену, агрегаты и справочник источников.

Object Storage (S3-compatible) — хранилище больших/неструктурированных артефактов: сырые тексты статей (JSON / raw HTML), нормализованные текстовые файлы, вложения и модели. Снижает нагрузку на БД и позволяет хранить полные исходники.

News Parser — парсер новостей, подключается к внешним источникам (RSS, API, соцсети), получает сырой контент и метаданные, сохраняет сами тексты в Object Storage и фиксирует ссылки/метаданные в БД (id, заголовок, время, источник).

Text Normalizer — модуль предобработки текста, берёт сырые артефакты из Object Storage, очищает HTML, убирает шум, выполняет токенизацию/лемматизацию и сохраняет результат обратно в Object Storage.

Sentiment Model (ML service) — модель оценки тональности, на вход получает нормализованные тексты из Object Storage, вычисляет тональность и confidence, пишет результаты в БД.

Price Prediction Model (ML service) — модель для прогнозирования влияния новости на цену, берёт фичи из БД (тональность, агрегаты, рыночные фичи), при необходимости запрашивает исторические/текущие цены у внешних провайдеров, генерирует прогноз (рост/падение/нейтрально) и сохраняет выводы в БД.

Monitoring — сбор метрик и логов от всех модулей (parser, normalizer, ML services, БД). Предоставляет администратору дашборды состояния и оповещения о проблемах.

### Причины выбора базового архитектурного стиля

Стиль: модульный, event-driven по данным + централизованное хранилище для аналитики.

Парсер, нормализатор и модели — отдельные модули, что упрощает разработку, тестирование и замену отдельных частей (например, заменить модель без изменения парсера). Object Storage позволяет хранить сырые и нормализованные артефакты для повторного прогона моделей — критично для корректности аналитики и отката.

Единая БД (Postgres) служит быстрым и простым источником для SQL-запросов — Grafana нативно работает с такими БД и с алертами по SQL. 

ML-сервисы можно масштабировать отдельно от парсера; Object Storage и БД масштабируются независимо, что обеспечивает экономичное и гибкое развертывание.


## Диаграмма компонентов

![Untitled - Component (1)](https://github.com/user-attachments/assets/bafa4ab3-2896-482c-8825-76f7e9fe21f2)

### Компоненты внутри контейнера «Парсер новостей»

Модуль загрузки новостей - самполучает новости от внешних источников:
– через RSS,
– через API,
– через webhooks,
– из потоковых источников.

Модуль извлечения текста - берёт HTML страницы и извлекает:
– заголовок,
– текст новости,
– возможно — картинки.
Удаляет лишние элементы вроде меню, баннеров, рекламных блоков.

Модуль метаданных - определяет ключевые данные новости:
– источник,
– время публикации,
– автора,
– URL,
– язык.

Модуль удаления дублей - проверяет, была ли такая новость уже загружена, помогает избежать повторной обработки одного и того же материала.

Модуль сохранения - сохраняет оригинальный текст в файловом хранилище и записывает основные данные в базу данных.

Модуль оповещения о новой статье - сообщает другим частям системы (нормализатору), что появилась новая новость, которую нужно обработать дальше.

Модуль обработки ошибок - следит за ошибками:
– делает повторные попытки при временных сбоях;
– отправляет сообщения об ошибках в мониторинг;
– записывает проблемные события для анализа.
